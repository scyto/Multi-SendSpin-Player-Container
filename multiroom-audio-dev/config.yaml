name: Multi-Room Audio (Dev)
version: "sha-b5db2df"
slug: multiroom-audio-dev
description: >-
  Development builds - may be unstable. Sendspin-powered multi-room audio
  controller for testing new features.
url: https://github.com/chrisuthe/squeezelite-docker
image: ghcr.io/scyto/multiroom-audio-hassio-dev
startup: services
arch:
  - amd64
  - aarch64

# Hardware access
audio: true
host_network: true
udev: true
uart: true
usb: true
# Explicit device mapping for audio access
devices:
  - "/dev/snd:/dev/snd"

# Full system access (matching squeezelite for debugging)
# TODO: Remove once we identify minimum required permissions
full_access: true

# Permissions for audio processing
privileged:
  - SYS_NICE
  - SYS_ADMIN   # Broad system admin (squeezelite uses this)
  - SYS_PTRACE  # Process tracing (squeezelite uses this)
  - IPC_LOCK    # Lock memory pages - prevents swap, critical for RT audio
apparmor: false  # Disabled with full_access

# Storage mapping
map:
  - config:rw
  - share:rw

# Web interface via ingress only (no direct port exposure)
ingress: true
ingress_port: 8096
panel_icon: mdi:speaker-multiple
panel_title: Multi-Room Audio (Dev)

# User-configurable options
options:
  log_level: info
  relay_devices: []
  mock_hardware: false
  enable_advanced_formats: false
  pa_buffer_ms: 50

schema:
  log_level: list(debug|info|warning|error)
  relay_serial_port: device(subsystem=tty)?
  relay_devices:
    - str?
  mock_hardware: bool?
  enable_advanced_formats: bool?
  pa_buffer_ms: int(10,2000)?

# Watchdog - auto-restart if health check fails
watchdog: http://[HOST]:[PORT:8096]/api/health

# Build stage - experimental hides unless enabled in settings
stage: experimental
init: false
